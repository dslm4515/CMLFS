# llvmtools: Perl 5.32.1
# Build and install as cmlfs

# ** Perl 5.36.0 + perl-cross-1.4 fail to build. Likely, perl 5.36.0 will compile in chroot  **

# Use perl-cross, by copying over perl source
cd .. &&
tar xf perl-cross-1.4.tar.gz
cd perl-5.32.1 &&
cp -vrf ../perl-cross-1.4/* ./
cp -vrf ../perl-cross-1.4/utils/* utils/

# Configure source with clang
CC=x86_64-pc-linux-musl-clang \
CXX=x86_64-pc-linux-musl-clang++ \
AR=llvm-ar \
AS=llvm-as \
RANLIB=llvm-ranlib \
LD=ld.lld \
STRIP=llvm-strip \
READELF=llvm-readelf \
OBJDUMP=llvm-objdump \
./configure --target=${TARGET_TUPLE} \
            --build=${TARGET_TUPLE} \
            --prefix=/llvmtools

# Build
make

# Only a few of the utilities and libraries need to be installed to toolchain
cp -v perl cpan/podlators/scripts/pod2man /llvmtools/bin
mkdir -pv /llvmtools/lib/perl5/5.32.1
cp -Rv lib/* /llvmtools/lib/perl5/5.32.1

