# Final System: libreSSL
# Build under chroot

# Run autoreconf
autoreconf -vif

# Set a few variables ...
case $(uname -m) in
 x86_64)  export EXTRACONFIG=""
          export TUPLE="x86_64-linux-musl"
         ;;
 i686)    export EXTRACONFIG="--disable-hardening"
          export TUPLE="i686-linux-musl"
         ;;
 armv7l)  export TUPLE="armv7l-linux-musleabihf"
         ;;
 armv6l)  export TUPLE="armv6l-linux-musleabihf"
         ;;
 aarch64) export TUPLE="aarch64-linux-musleabihf"
         ;;
esac

CC=clang CXX=clang++       \
CFLAGS="-L/usr/lib " \
./configure \
           --build=$TUPLE \
           --host=$TUPLE \
           --prefix=/usr \
           --sysconfdir=/etc \
           --mandir=/usr/share/man \
           --localstatedir=/var $EXTRACONFIG


unset EXTRACONFIG TUPLE

# Build and install
make && make install
