cd ${LLVMSRC}/projects/libcxxabi

cmake -B build -G Ninja \
      -DCMAKE_INSTALL_PREFIX="/cgnutools" \
      -DCMAKE_C_COMPILER="${CMLFS_TARGET}-gcc" \
      -DCMAKE_CXX_COMPILER="${CMLFS_TARGET}-g++" \
      -DCMAKE_SHARED_LINKER_FLAGS="-L/cgnutools/lib" \
      -DLIBCXXABI_ENABLE_STATIC=ON \
      -DLIBCXXABI_USE_LLVM_UNWINDER=ON \
      -DLLVM_PATH="${LLVMSRC}" \
      -DLIBCXXABI_LIBUNWIND_PATH="${LLVMSRC}/projects/libunwind" \
      -DLIBCXXABI_LIBCXX_INCLUDES="${LLVMSRC}/projects/libcxx/include" && \

ninja -C build         && \
ninja -C build install && \
rm -rf build           && \

# Link libcxxabi to final toolchain. Libraries will be replaced once
# libcxxabi is rebuilt with clang
ln -vs /cgnutools/lib/libc++abi* /llvmtools/lib/

# Copy libcxxabi headers
cp -v include/*.h /cgnutools/include/


