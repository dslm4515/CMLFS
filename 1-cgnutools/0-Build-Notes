# General Build Notes for cgnutools

# Builds for cgnutools assume the following:
# o bash is the shell in use
# o sh is a symbolic link to bash
# o /usr/bin/awk is a symbolic link to gawk
# o /usr/bin/yacc is a symbolic link to bison
#   or a script that executes bison
# o flex is required when building source snapshots of GCC

echo $SHELL
file /bin/sh
file /usr/bin/awk
file /usr/bin/yacc
which flex

# Make sure building cgnutools as cmlfs
whoami

# Make sure PATH is set correctly:
export PATH=/cgnutools/bin:/llvmtools/bin:/usr/bin:/bin

# Each package should be unpacked in /mnt/cmlfs/source and change 
# to the unpacked source directory. For example:
cd /mnt/cmlfs/sources
tar xf pkgs/foo-1.2.3.tar.gz
cd foo-1.2.3

# Then patch and compile per instruction
patch -Np1 -i ../patches/foo-mlfs/fix-it.patch
./configure --prefix=/cgnutools
make 
make install

# After the package is installed, change directories and remove
# unpacked source directory unless instructed:
cd ..
rm -rf foo-1.2.3

# Extra notes:
# Most compilers provide a way to disable the 
# default behavior for finding the standard 
# library and to override it with custom paths. 
# With Clang, this can be done with:

clang++ -nostdinc++ -nostdlib++           \
        -isystem <install>/include/c++/v1 \
        -L <install>/lib                  \
        -Wl,-rpath,<install>/lib          \
        -lc++                             \
        test.cpp

# Cross GCC (mussel)
# Bin directory: /cgnutools/bin/${TARGET_TUPLE}-*
# Header search paths:
#  o /cgnutools/bin/../lib/gcc/x86_64-pc-linux-musl/12.2.0/../../../../x86_64-pc-linux-musl/include
#  o /cgnutools/lib/gcc/x86_64-pc-linux-musl/12.2.0/include
#  o /cgnutools/usr/include
#  Library search paths:
#  o /cgnutools/x86_64-pc-linux-musl/lib64
#  o /usr/local/lib64
#  o /lib64
#  o /usr/lib64
#  o /cgnutools/x86_64-pc-linux-musl/lib
#  o /usr/local/lib
#  Sysroot = /cgnutools
